<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="POS.Views.Manager.DiscountManagementPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:POS.Views.Manager"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="using:POS.ViewModels"
    xmlns:model="using:POS.Models"
    mc:Ignorable="d">

    <Page.Resources>

    </Page.Resources>

    <!-- (Main Content) -->
    <SplitView x:Name="MenuSplitView"
               IsPaneOpen="{Binding IsPaneOpen}"
               DisplayMode="Inline"
               PaneBackground="{ThemeResource CardBackgroundFillColorDefaultBrush}"
               PanePlacement="Right">
        <StackPanel HorizontalAlignment="Stretch" Orientation="Vertical">

            <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="5*" />
                    <ColumnDefinition Width="2*" />
                </Grid.ColumnDefinitions>


                <StackPanel Grid.Column="0" Orientation="Horizontal">

                    <Button
                        x:Name="addEmployeeBtn"
                        Margin="0,0,10,0"
                        Background="#9ef8a0"
                        Click="addEmployeeBtn_Click"
                        Content="Thêm Discount"
                        Foreground="#356c34" />
                    <Button
                        x:Name="DeleteBtn"
                        Margin="0,0,5,0"
                        Background="Red"
                        Click="DeleteBtn_Click"
                        Content="Xóa"
                        Foreground="Black" />


                </StackPanel>


                <AutoSuggestBox
                    x:Name="SearchBar"
                    Grid.Column="1"
                    Width="300"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                    PlaceholderText="Type a Discount name"
                    QueryIcon="Find"/>

            </Grid>



            <Border
                Margin="0,10,0,10"
                BorderBrush="Gray"
                BorderThickness="0,0,0,1" />
            <!--  Divider  -->


            <Grid x:Name="Grid" HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="5*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>


                <ScrollViewer
                    x:Name="ScrollViewListDiscount"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Top"
                    HorizontalScrollBarVisibility="Auto"
                    HorizontalScrollMode="Enabled"
                    IsTabStop="True"
                    IsVerticalScrollChainingEnabled="True"
                    VerticalScrollBarVisibility="Auto"
                    VerticalScrollMode="Enabled"
                    ZoomMode="Enabled">

                    <ListView
                        x:Name="ListDiscount"
                        Height="500"
                        ItemsSource="{x:Bind ViewModel.FilteredDiscounts}">
                        <!--  *******************HEADER***************  -->
                        <ListView.Header>
                            <Grid Padding="16,6" ColumnSpacing="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50" />
                                    <ColumnDefinition Width="0.4*" />
                                    <ColumnDefinition Width="1.5*" />
                                    <ColumnDefinition Width="2*" />
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="1.5*" />
                                    <ColumnDefinition Width="1.5*" />
                                    <ColumnDefinition Width="1.2*" />

                                </Grid.ColumnDefinitions>

                                <CheckBox
                                    x:Name="HeaderCheckBox"
                                    Grid.Column="0"
                                    Width="10"
                                    Padding="0,0,1,0"
                                    HorizontalAlignment="Stretch"
                                    Checked="HeaderCheckBox_Checked"
                                    FontSize="10"
                                    Unchecked="HeaderCheckBox_Unchecked" />

                                <TextBlock
                                    Grid.Column="1"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    VerticalAlignment="Center"
                                    Text="ID" />
                                <TextBlock
                                    Grid.Column="2"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    VerticalAlignment="Center"
                                    Text="Name" />
                                <TextBlock
                                    Grid.Column="3"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    VerticalAlignment="Center"
                                    Text="Description" />  
                                <TextBlock
                                    Grid.Column="4"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    VerticalAlignment="Center"
                                    Text="Percentage" />
                                <TextBlock
                                    Grid.Column="5"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    VerticalAlignment="Center"
                                    Text="Is Disabled" />
                                <TextBlock
                                    Grid.Column="6"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    VerticalAlignment="Center"
                                    Text="Start Date" />
                                <TextBlock
                                    Grid.Column="7"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    VerticalAlignment="Center"
                                    Text="End Date" />
                                <TextBlock
                                    Grid.Column="8"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    VerticalAlignment="Center"
                                    Text="Actions" />
                            </Grid>
                        </ListView.Header>

                        <ListView.ItemTemplate>
                            <!--  *******************DATA***************  -->

                            <DataTemplate x:DataType="model:Discount">
                                <Grid ColumnSpacing="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50" />
                                        <ColumnDefinition Width="0.4*" />
                                        <ColumnDefinition Width="1.5*" />
                                        <ColumnDefinition Width="2*" />
                                        <ColumnDefinition Width="1*" />
                                        <ColumnDefinition Width="1*" />
                                        <ColumnDefinition Width="1.5*" />
                                        <ColumnDefinition Width="1.5*" />
                                        <ColumnDefinition Width="1.2*" />

                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" Checked="ListItemCheckBox_Checked" Unchecked="ListItemCheckBox_Unchecked"  />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Id}" VerticalAlignment="Center" />
                                    <TextBlock Grid.Column="2" Text="{x:Bind Name}" VerticalAlignment="Center" />
                                    <TextBlock Grid.Column="3" Text="{x:Bind Description}" VerticalAlignment="Center" />
                                    <TextBlock Grid.Column="4" Text="{x:Bind Percentage}" VerticalAlignment="Center" />
                                    <TextBlock Grid.Column="5" Text="{x:Bind IsDisabled}" VerticalAlignment="Center" />
                                    <TextBlock Grid.Column="6" Text="{x:Bind StartDate}" VerticalAlignment="Center" />
                                    <TextBlock Grid.Column="7" Text="{x:Bind EndDate}" VerticalAlignment="Center" />
                                    <StackPanel
                                        Grid.Column="8"
                                        Margin="0,0,10,0"
                                        Orientation="Horizontal">
                                        <Button Click="ActionDeleteBtn_Click" Margin="0,0,2,0">
                                            <FontIcon
                                                Width="15"
                                                Height="15"
                                                FontSize="15"
                                                Foreground="Red"
                                                Glyph="&#xE74D;" />
                                        </Button>
                                        <Button Click="EditDiscountButton_Click">
                                            <FontIcon
                                                FontSize="15"
                                                Foreground="Yellow"
                                                Glyph="&#xF742;" />
                                        </Button>

                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>

                        <ListView.ItemContainerStyle>
                            <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                    </ListView>
                </ScrollViewer>



            </Grid>


            <StackPanel
                Margin="0,10,0,10"
                HorizontalAlignment="Center"
                Orientation="Horizontal">
                <Button
                    Click="PrevPage_Click"
                    Content="Trước"
                    IsEnabled="{x:Bind HasPreviousPage}" />
                <TextBlock
                    Margin="10,0,10,0"
                    VerticalAlignment="Center"
                    Text="{x:Bind PageInfo}" />
                <Button
                    Click="NextPage_Click"
                    Content="Sau"
                    IsEnabled="{x:Bind HasNextPage}" />

            </StackPanel>



        </StackPanel>

        <!-- SplitView for displaying selected menu item details -->
        <SplitView.Pane>
            <Grid Margin="20">
                <StackPanel x:Name="AddDiscountPanel" Visibility="Collapsed">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <TextBlock Text="Thêm discount" FontSize="24" FontWeight="Bold" />
                        <Button Margin="30,3,0,0" BorderThickness="0" Click="CloseMenuItemPanelButton_Click">
                            <StackPanel>
                                <SymbolIcon Symbol="Cancel" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                    <TextBox x:Name="DiscountNameTextBox" Header="Tên discount" PlaceholderText="Ví dụ: Winter Sale"
                             Margin="0,0,0,20" /> 
                    <TextBox x:Name="DiscountDescriptionTextBox" Header="Mô tả" PlaceholderText="Giáng sinh"
                             Margin="0,0,0,20" />
                    <NumberBox x:Name="DiscountPercentageNumberBox" Header="Phần trăm giảm" PlaceholderText="0" Margin="0,0,0,20" />
                    <CalendarDatePicker x:Name="DiscountStartDatePicker" Header="Ngày bắt đầu" PlaceholderText="Chọn ngày" Margin="0,0,0,20" MinWidth="150" MaxWidth="250" />
                    <CalendarDatePicker x:Name="DiscountEndDatePicker" Header="Ngày kết thúc" PlaceholderText="Chọn ngày" Margin="0,0,0,20" MinWidth="150" MaxWidth="250" />

                    <Button Content="Lưu" Background="DarkSlateBlue" Foreground="White" Padding="10,10"
                            HorizontalAlignment="Stretch" Click="SaveDiscountButton_Click" Margin="0,0,0,10" />
                </StackPanel>
                
                <StackPanel x:Name="EditDiscountPanel" Visibility="Collapsed">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <TextBlock Text="Chỉnh sửa discount" FontSize="24" FontWeight="Bold" />
                        <Button Margin="10,3,0,0" BorderThickness="0" Click="CloseMenuItemPanelButton_Click">
                            <StackPanel>
                                <SymbolIcon Symbol="Cancel" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                    <TextBox x:Name="EditDiscountNameTextBox" Header="Tên discount" PlaceholderText="Ví dụ: Winter Sale"
                             Margin="0,0,0,20" />
                    <TextBox x:Name="EditDiscountDescriptionTextBox" Header="Mô tả" PlaceholderText="Giáng sinh"
                             Margin="0,0,0,20" />
                    <NumberBox x:Name="EditDiscountPercentageNumberBox" Header="Phần trăm giảm" PlaceholderText="0" Margin="0,0,0,20" />
                    <CheckBox x:Name="EditDiscountIsDisabledCheckBox" Content="Vô hiệu hóa" 
                              Margin="0,0,0,20" />
                    <CalendarDatePicker x:Name="EditDiscountStartDatePicker" Header="Ngày bắt đầu" PlaceholderText="Chọn ngày" Margin="0,0,0,20" MinWidth="150" MaxWidth="250" />
                    <CalendarDatePicker x:Name="EditDiscountEndDatePicker" Header="Ngày kết thúc" PlaceholderText="Chọn ngày" Margin="0,0,0,20" MinWidth="150" MaxWidth="250" />

                    <Button Content="Lưu" Background="DarkSlateBlue" Foreground="White" Padding="10,10"
                            HorizontalAlignment="Stretch" Click="SaveEditDiscountButton_Click" Margin="0,0,0,10" />
                    <Button Content="Xóa Discount" Background="DarkRed" Foreground="White" Padding="10,10"
                            HorizontalAlignment="Stretch" Click="DeleteDiscountPanelButton_Click" />
                </StackPanel>
            </Grid>
        </SplitView.Pane>

        <!-- VisualStateManager for responsive design -->
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState x:Name="NarrowState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MenuSplitView.DisplayMode" Value="Overlay" />
                        <Setter Target="MenuSplitView.OpenPaneLength" Value="300" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="WideState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="720" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MenuSplitView.DisplayMode" Value="Inline" />
                        <Setter Target="MenuSplitView.OpenPaneLength" Value="300" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </SplitView>
</Page>