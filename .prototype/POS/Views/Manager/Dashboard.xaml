<Page
    x:Class="POS.Views.Manager.Dashboard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:POS.Views.Manager"
    xmlns:lvc="using:LiveChartsCore.SkiaSharpView.WinUI"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:painting="using:LiveChartsCore.SkiaSharpView.Painting"
    xmlns:painting2="clr-namespace:SkiaSharp;assembly=SkiaSharp"
    xmlns:skia="clr-namespace:SkiaSharp;assembly=SkiaSharp"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />

        </Grid.RowDefinitions>

        <!--  Statistics Tiles  -->
        <Grid Grid.Row="0" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!--  Total Sales Tile  -->
            <Border
                Grid.Column="0"
                Height="100"
                Margin="5"
                Background="#673AB7"
                CornerRadius="10">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock
                        FontSize="14"
                        Foreground="White"
                        Text="Total Sales" />
                    <TextBlock FontSize="24" Foreground="White">
                        <Run Text="{Binding TotalSales, Mode=OneWay}" />
                        <Run Text="VND" />
                    </TextBlock>
                </StackPanel>
            </Border>

            <!--  Sales by Shift Tile  -->
            <Border
                Grid.Column="1"
                Height="100"
                Margin="5"
                Background="#2196F3"
                CornerRadius="10">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock
                        FontSize="14"
                        Foreground="White"
                        Text="Avarage revenue per transaction" />
                    <TextBlock FontSize="24" Foreground="White">
                        <Run Text="{Binding AverageAvenuePerTransaction, Mode=OneWay}" />
                        <Run Text="VND" />
                    </TextBlock>
                </StackPanel>
            </Border>

            <!--  Top Selling Products Tile  -->
            <Border
                Grid.Column="2"
                Height="100"
                Margin="5"
                Background="#FF9800"
                CornerRadius="10">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock
                        FontSize="14"
                        Foreground="White"
                        Text="Customer Returning Rate" />
                    <TextBlock FontSize="24" Foreground="White">
                        <Run Text="{Binding CustomerReturning, Mode=OneWay}" />
                        <Run Text="%" />
                    </TextBlock>
                </StackPanel>
            </Border>

            <!--  Slow Selling Products Tile  -->
            <Border
                Grid.Column="3"
                Height="100"
                Margin="5"
                Background="#F44336"
                CornerRadius="10">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock
                        FontSize="14"
                        Foreground="White"
                        Text="Top selling Products" />
                    <TextBlock
                        Margin="10,0,10,0"
                        VerticalAlignment="Center"
                        FontSize="24"
                        Foreground="White">
                        <Run Text="{Binding KeyProduct, Mode=OneWay}" />
                        <Run Text=" / " />
                        <Run Text="{Binding RevenueKeyProduct, Mode=OneWay}" />
                    </TextBlock>
                </StackPanel>
            </Border>
        </Grid>

        <!--  Filters for Time Range  -->
        <StackPanel
            Grid.Row="1"
            Margin="10"
            HorizontalAlignment="Left"
            Orientation="Horizontal">
            <!--  Date Filter  -->



            <!--  Date Picker for custom date selection  -->
            <!--<DatePicker
                Name="CustomDatePicker"
                Margin="10,0,0,0"
                SelectedDate="{Binding SelectedDate}"
                Visibility="{Binding IsCustomDateVisible}" />-->
        </StackPanel>

        <!--  Charts Section  -->
        <ScrollViewer
            Grid.Row="2"
            Height="550"
            Margin="10"
            VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!--  Chart 1 - Total Sales by Time  -->


                <CalendarDatePicker
                    x:Name="myCalendarDatePicker"
                    Width="250"
                    HorizontalAlignment="Left"
                    DateChanged="myCalendarDatePicker_DateChanged"
                    DateFormat="{}{dayofweek.full}‎, ‎{month.full}‎ ‎{day.integer}‎, ‎{year.full}" />
                <ComboBox
                    Width="200"
                    HorizontalAlignment="Right"
                    DisplayMemberPath="Item1"
                    ItemsSource="{Binding SelectedTimePeriod}"
                    Loaded="Combo2_Loaded"
                    SelectedValuePath="Item2"
                    SelectionChanged="ComboBoxChart1_SelectionChanged" />
                <Border Height="300" Margin="0,0,0,20">
                    <lvc:CartesianChart
                        Title="{Binding TitleChart1}"
                        Series="{Binding Chart1}"
                        XAxes="{Binding XAxesChart1}"
                        YAxes="{Binding YAxesChart1}" />
                </Border>

                <!--  Chart 2 - Sales by Shift  -->
                <ComboBox
                    Width="200"
                    Margin="0,100,0,50"
                    HorizontalAlignment="Right"
                    DisplayMemberPath="Item1"
                    ItemsSource="{Binding SelectedTimePeriod2}"
                    Loaded="ComboBox_Loaded"
                    SelectedValuePath="Item2"
                    SelectionChanged="ComboBox_SelectionChanged" />
                <Border Height="300" Margin="0,0,0,20">
                    <lvc:PieChart
                        Title="{Binding TitleChart2, Mode=OneWay}"
                        LegendPosition="Right"
                        LegendTextPaint="{Binding LegendTextPaint}"
                        Series="{Binding Chart2}" />

                </Border>


                <ComboBox
                    Width="200"
                    Margin="0,100,0,0"
                    HorizontalAlignment="Right"
                    DisplayMemberPath="Item1"
                    ItemsSource="{Binding SelectedTimePeriod3}"
                    Loaded="ComboBox_Loaded"
                    SelectedValuePath="Item2"
                    SelectionChanged="ComboBox_SelectionChanged_Chart3" />
                <Border Height="300" Margin="0,0,0,20">
                    <lvc:CartesianChart
                        Title="{Binding TitleChart3, Mode=OneWay}"
                        LegendPosition="Right"
                        LegendTextPaint="{Binding LegendTextPaint}"
                        Series="{Binding Chart3}"
                        XAxes="{Binding XAxesChart3}"
                        YAxes="{Binding YAxesChart3}" />
                </Border>
                <Grid Margin="10">
                    <!-- Define two columns -->
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <!-- Left column for the calendar -->
                        <ColumnDefinition Width="Auto" />
                        <!-- Right column for ComboBox and Button -->
                    </Grid.ColumnDefinitions>

                    <!-- CalendarDatePicker in the left column -->
                    <CalendarDatePicker
                        x:Name="MonthYearPicker"
                        Width="250"
                        HorizontalAlignment="Left"
                        DateChanged="MonthYearPicker_DateChanged"
                        DateFormat="{}{month.full}, ‎{year.full}" />

                    <!-- StackPanel for ComboBox and Button in the right column -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10">
                        <ComboBox
                            x:Name="TopProductsComboBox"
                            Width="150"
                            PlaceholderText="Select Top N"
                            SelectedValue="{Binding TopProductsCount, Mode=TwoWay}"
                            SelectedValuePath="Content">
                            <ComboBoxItem Content="1" />
                            <ComboBoxItem Content="3" />
                            <ComboBoxItem Content="5" />
                            <ComboBoxItem Content="10" />
                        </ComboBox>
                        <Button
                            Background="#9ef8a0"
                            Click="ImportModelButton_Click"
                            Content="Import model"
                            Foreground="Black" />
                        <Button
                            Background="#f3908e"
                            Click="LoadButton_Click"
                            Content="Load"
                            Foreground="Black" />
                    </StackPanel>
                </Grid>

                <Border Height="300" Margin="0,0,0,20">
                    <lvc:PieChart
                        Visibility="Visible"
                        Title="{Binding TitleChart4, Mode=TwoWay}"
                        LegendPosition="Right"
                        LegendTextPaint="{Binding LegendTextPaint}"
                        Series="{Binding TopProductsSeries, Mode=OneWay}" />
                </Border>

                <Border Height="300" Margin="0,0,0,20">
                    <lvc:CartesianChart
                        Series="{Binding Chart5}"
                        XAxes="{Binding XAxesChart5}"
                        YAxes="{Binding YAxesChart5}" />
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
